<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inkjection Tattoo</title>
    <style>
        :root { --bg:#000; --text:#fff; --accent:#25D366; }
        body { background:#000; color:#fff; font-family:sans-serif; text-align:center; margin:0; padding:20px; }
        .btn { display:inline-block; padding:15px 30px; margin:10px; border-radius:30px; text-decoration:none; font-weight:bold; transition: 0.3s; }
        .whatsapp { background:#25D366; color:#fff; }
        .facebook { background:#1877F2; color:#fff; }
        .btn:hover { transform: scale(1.05); opacity: 0.9; }
        #calendar { display:grid; grid-template-columns:repeat(7, 1fr); gap:8px; max-width:400px; margin:30px auto; padding:10px; }
        .day { padding:12px 5px; border:1px solid #333; font-size:13px; border-radius:8px; background:#111; }
        .booked { background:#ff4444 !important; color:#fff !important; text-decoration:line-through; opacity:0.7; border-color:#ff4444; }
        .free { color:#25D366; border-color:#25D366; }
        h1 { margin-bottom: 5px; }
        p { color: #888; font-size: 14px; margin-bottom: 25px; }
    </style>
</head>
<body>
    <h1>Inkjection Tattoo</h1>
    <p>Dolu günler kırmızı ile işaretlenmiştir. Randevu için yazın.</p>
    
    <a href="https://wa.me/32465313881" class="btn whatsapp">WhatsApp: Resim Gönder</a>
    <a href="https://www.facebook.com/share/15ZpY9N4K8/?mibextid=wwXIfr" class="btn facebook">Facebook Sayfamız</a>

    <div id="calendar"></div>

    <script>
        async function loadData() {
            // Senin güncel tablo ID'n ve sayfa ismin
            const sheetId = '1-Cmr2UoQB89Oo4D-Qcukhr7CGjs7eAEJbuSlWtyjFk4';
            const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=Sayfa1`;
            
            try {
                const res = await fetch(url);
                const txt = await res.text();
                const json = JSON.parse(txt.substr(47).slice(0, -2));
                
                const bookedDates = json.table.rows.map(row => {
                    let val = row.c[0] ? row.c[0].v : null;
                    let status = row.c[1] ? row.c[1].v : '';
                    
                    if (val && status === 'booked') {
                        // 1. Durum: Google'ın otomatik tarih formatı
                        if (typeof val === 'string' && val.includes('Date')) {
                            const m = val.match(/\d+/g);
                            return `${m[0]}-${(parseInt(m[1])+1).toString().padStart(2,'0')}-${m[2].padStart(2,'0')}`;
                        }
                        // 2. Durum: Senin girdiğin 'Düz Metin' formatı (2026-01-05)
                        return val.toString().trim(); 
                    }
                    return null;
                }).filter(x => x);

                renderCalendar(bookedDates);
            } catch (e) { 
                console.error("Veri yüklenemedi:", e); 
            }
        }

        function renderCalendar(booked) {
            const cal = document.getElementById('calendar');
            const today = new Date();
            // Gelecek 30 günü göster
            for(let i=0; i<30; i++) {
                const d = new Date(today);
                d.setDate(today.getDate() + i);
                
                // Tarihi YYYY-MM-DD formatına çevirerek eşleştir
                const year = d.getFullYear();
                const month = (d.getMonth() + 1).toString().padStart(2, '0');
                const day = d.getDate().toString().padStart(2, '0');
                const iso = `${year}-${month}-${day}`;
                
                const div = document.createElement('div');
                div.className = 'day ' + (booked.includes(iso) ? 'booked' : 'free');
                div.innerText = d.getDate() + "/" + (d.getMonth()+1);
                cal.appendChild(div);
            }
        }
        loadData(); [cite: 2025-12-24]
    </script>
</body>
</html>
